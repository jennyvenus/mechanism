本代码写于1999年前后，后来最新版代码找不到了，所以使用了一个接近最终版的代码又修改了一下。